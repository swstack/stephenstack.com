<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12" id="login_content">
            <div id="gSignInWrapper">
			    <h2>Login with, </h2>
			    <div id="signinBtn" class="gplusButton">
			        <span class="icon"></span>
			        <span class="buttonText">Google</span>
			    </div>
			</div>
	        <div id="profile" style="display:none">
		        <h2 id="welcome_back">Welcome back, </h2>
		        <div id="user_profile_pic"></div>
		        <div id="logoutBtn" class="gplusButton">
                    <span class="icon"></span>
                    <span class="buttonText">Logout</span>
                </div>
			</div>
        </div>
    </div>
</div>

<div class="row-fluid">
    <div class="span12">
        <h1 id="site_end">return);</h1>
    </div>
</div>

<script type="text/javascript">
	function onSignInCallback(authResult) {
	    if (authResult['access_token']) {
	    	// success, user signed in
	    	_signIn(authResult.code);
            $('#profile').show('slow');
            $('#gSignInWrapper').hide();
        } else if (authResult['error']) {
           // error, user not signed in
           console.log('There was an error: ' + authResult['error']);
           $('#profile').hide('slow');
           $('#gSignInWrapper').show();
        }
	}
	
	function _signIn(auth_code) {
		$.ajax({
	        type : 'POST',
	        url : '/login/{{ STATE }}',
	        contentType : 'application/octet-stream; charset=utf-8',
	        success : function(userData) {
	        	_renderProfile($.parseJSON(userData));
	        },
	        processData : false,
	        data : auth_code
	    });
	}
	
	function _renderProfile (userData) {
		$("#welcome_back").append(userData.displayName);
		$("#user_profile_pic").append(
				$('<p><img src=\"' + userData.image.url + '\"></p>')
		);
	}
	
	$("#logoutBtn").click(function(){
		$.ajax({
			type : 'POST',
            url : "/logout",
            async : false,
            success : function(result) {
                console.log('revoke response: ' + result);
                $('#profile').hide();
                $('#profile').empty();
                $('#gSignInWrapper').show();
            },
            error : function(e) {
                console.log(e);
            }
        });
	});
</script>
